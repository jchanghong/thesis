\noindent
\ttfamily
\hlstd{}\hllin{01\ }\hlstd{}\hlcom{/{*}{*}}\\
\hllin{02\ }\hlcom{\ {*}\ 前端认证处理器}\\
\hllin{03\ }\hlcom{\ {*}\ 处理auth包}\\
\hllin{04\ }\hlcom{\ {*}/}\hlstd{}\\
\hllin{05\ }\hlstd{}\hlkwc{@Component}\\
\hllin{06\ }\hlstd{}\hlkwa{open\ class\ }\hlstd{MysqlAuthHander\ }\hlopt{:\ }\hlstd{MysqlPacketHander\ }\hlopt{\symbol{123}}\\
\hllin{07\ }\hlstd{}\hlstd{\ \ \ \ }\hlstd{}\hlkwa{private\ fun\ }\hlstd{}\hlkwd{handle0}\hlstd{}\hlopt{(}\hlstd{auth}\hlopt{:\ }\hlstd{AuthPacket}\hlopt{,\ }\hlstd{source}\hlopt{:\ }\hlstd{OConnection}\hlopt{)\ \symbol{123}}\\
\hllin{08\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ }\hlstd{source}\hlopt{.}\hlstd{schema\ }\hlopt{=\ }\hlstd{auth}\hlopt{.}\hlstd{database}\\
\hllin{09\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ }\hlstd{}\hlslc{//\ check\ password}\\
\hllin{10\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{if\ }\hlstd{}\hlopt{(!}\hlstd{}\hlkwd{checkPassword}\hlstd{}\hlopt{(}\hlstd{auth}\hlopt{.}\hlstd{password}\hlopt{!!,\ }\hlstd{auth}\hlopt{.}\hlstd{user}\hlopt{!!))\ \symbol{123}}\\
\hllin{11\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwa{if\ }\hlstd{}\hlopt{(}\hlstd{config}\hlopt{.}\hlstd{audit}\hlopt{)\ \symbol{123}}\\
\hllin{12\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwd{LoginLog}\hlstd{}\hlopt{(}\hlstd{auth}\hlopt{.}\hlstd{user\ ?}\hlopt{:\ }\hlstd{}\hlstr{"null"}\hlstd{}\hlopt{,\ }\hlstd{source}\hlopt{.}\hlstd{host}\hlopt{,\ }\hlstd{}\hlkwa{false}\hlstd{}\hlopt{).}\hlstd{}\hlkwd{sendesServer}\hlstd{}\hlopt{()}\\
\hllin{13\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlopt{\symbol{125}}\\
\hllin{14\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwd{failure}\hlstd{}\hlopt{(}\hlstd{ErrorCode}\hlopt{.}\hlstd{ER\symbol{95}ACCESS\symbol{95}DENIED\symbol{95}ERROR}\hlopt{,}\\
\hllin{15\ }\hlstd{}\hlstd{\ \ \ \ \ \ }\hlstd{}\hlstr{"Access\ denied\ for\ user\ '"}\hlstd{\ }\hlopt{+\ }\hlstd{auth}\hlopt{.}\hlstd{user\ }\hlopt{+\ }\hlstd{}\hlstr{"',\ }\\
\hllin{16\ }\hlstr{}\hlstd{\ \ \ \ \ \ }\hlstr{because\ password\ is\ error\ "}\hlstd{}\hlopt{,\ }\hlstd{source}\hlopt{)}\\
\hllin{17\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ }\hlstd{}\hlopt{\symbol{125}\ }\hlstd{}\hlkwa{else\ }\hlstd{}\hlopt{\symbol{123}}\\
\hllin{18\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ \ \ \ \ }\hlstd{}\hlkwd{success}\hlstd{}\hlopt{(}\hlstd{auth}\hlopt{,\ }\hlstd{source}\hlopt{)}\\
\hllin{19\ }\hlstd{}\hlstd{\ \ \ \ \ \ \ \ }\hlstd{}\hlopt{\symbol{125}}\\
\hllin{20\ }\hlstd{}\hlstd{\ \ \ \ }\hlstd{}\hlopt{\symbol{125}}\\
\hllin{21\ }\hlstd{}\hlopt{\symbol{125}}\hlstd{}\\
\mbox{}
\normalfont
\normalsize
